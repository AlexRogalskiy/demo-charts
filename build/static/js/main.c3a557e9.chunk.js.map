{"version":3,"sources":["state.js","Admin.js","d3/visualisation.js","d3/partition.js","Team.js","Stats.js","Leaders.js","Reporting.js","App.js","index.js"],"names":["STREAM","ENGINEERING","OPERATIONS","PRODUCT","PORTFOLIO","DATA","DESIGN","KIND","EMPLOYEE","DEPARTMENT","TRIBE","SQUAD","TEAM","UNIT","TYPE","TEMP","CONTRACTOR","AGENCY_CONTRACTOR","Employee","id","name","title","reportsTo","memberOf","stream","number","github","startDate","type","Object","classCallCheck","this","Team","kind","parent","vacancies","techLead","productLead","description","backfills","data","Organisation","employees","teams","map","e","assign","sort","a","b","teamHierarchy","reporting","reportingHierarchy","rootEmployee","byId","forEach","t","root","teamsById","employeesById","employee","children","team","findLeadUpFromFor","values","push","hierarchy","members","filter","length","Error","concat","join","rootTeam","to","find","JSON","stringify","jsonString","parse","parseData","err","alert","headcount","parseInt","isNaN","undefined","toLowerCase","replace","makeTeamId","newName","newDescription","url","parsedURL","URL","protocol","startsWith","couch","Couch","host","pathname","substr","put","documentRevision","then","res","_this","rev","catch","message","persistURL","loadURL","auth","password","username","dataURL","toString","get","_this2","_rev","objectSpread","fetch","response","json","localStorage","setItem","_context2","t0","teamToRemove","parentTeamId","makeEmployeeId","employeeNumber","lead","searchKey","currentTeam","flattenTeamHierarchyExcluding","teamId","fn","r","reduce","debounce","func","wait","immediate","timeout","context","args","arguments","callNow","clearTimeout","setTimeout","apply","Admin","props","possibleConstructorReturn","getPrototypeOf","call","state","toJS","setState","_this3","react_default","createElement","dist","p","align","pb","w","style","alignSelf","Admin_TeamManager","onSelect","addNewTeam","actions","Admin_TeamDetails","maxHeight","overflow","Admin_EmployeeList","exclude","addToTeam","addEmployee","editEmployee","removeEmployee","React","Component","TeamDetails","_this4","onNameChange","val","debouncedChangeTeamName","onDescriptionChange","debouncedChangeTeamDescription","changeTeamName","changeTeamDescription","_this5","_this$props","reparentTeam","removeFromTeam","changeHeadcount","changeBackfills","removeTeam","setProductLead","setTechLead","upstreamEmlpoyeesStreams","toConsumableArray","Set","collectUpstreamEmployees","collection","indexOf","TextField_default","value","floatingLabelText","fullWidth","onChange","_","SelectField_default","__","i","MenuItem_default","key","primaryText","Card","keys","s","Subheader_default","List","onClick","secondaryText","multiLine","rowsMax","rows","RaisedButton_default","label","secondary","window","confirm","TeamManager","_ref","primaryTogglesNestedList","initiallyOpen","nestedItems","renderTeams","Admin_AddTeamDialog","parents","EmployeeList","_this6","handleSearchChange","event","search","target","handleFilterChange","isInputChecked","addPersonOpen","editedPerson","_this7","_this$props2","hintText","Checkbox_default","onCheck","sub","rightIconButton","IconButton_default","tooltip","mode_edit_default","Admin_AddPersonDialog","open","person","afterClose","AddPersonDialog","handleClose","_this8","submit","_this8$state","delete","nextProps","_this9","FlatButton_default","primary","Dialog_default","modal","onRequestClose","AddTeamDialog","handleOpen","_this10","_this10$state","_this11","RadioButton","labelPosition","valueSelected","visualisation","containerId","vizFactory","height","innerHeight","width","innerWidth","vizContainer","d3","append","classed","attr","on","viz","transform","defs","selectAll","remove","exportToSVG","html","node","parentNode","innerHTML","Blob","d3_partition","nodes","radius","Math","min","x","range","PI","y","color","d","always","group_actual","group","arc","startAngle","max","x0","endAngle","x1","innerRadius","y0","outerRadius","y1","getAngle","thetaDeg","partition","sum","rotate","start","angle","path","descendants","enter","shiftKey","matches","match","parseFloat","rotation","atan2","endsWith","text","transition","duration","tween","xd","domain","yd","yr","attrTween","inParent","subject","lookForID","checkWithinParent","arcText","select","depth","centroid","GraphHolder","showMembers","showVacancies","refs","chart","firstChild","removeChild","preparedTeams","_moveNodesToChildren","notRecursive","c","n","teamsPartition","renderChart","ref","TeamChart","toggleMembers","toggleVacancies","Toggle_default","toggled","onToggle","blob","FileSaver","saveAs","save_default","Team_GraphHolder","Stats","teamsFlat","Stats_StartDateList","Stats_NonEmployees","Stats_TwoLevelPieChart","Stats_StackedBarChart","engineering","product","design","operations","countVacancies","_ref2","portfolio","tally","console","log","StackedBarChart","_ref3","memberFilter","member","filterMembers","datas","f","es6","minHeight","dataKey","stackId","fill","TwoLevelPieChart","_ref4","streams","st","m","StartDateList","_ref5","NonEmployees","_ref6","Leaders","flatten","flattenTeamsFn","slice","newParents","Table","selectable","adjustForCheckbox","enableSelectAll","displaySelectAll","displayRowCheckbox","paddingLeft","opacity","current","findTechLeadNameUpwards","findProductLeadNameUpwards","employeesPartition","ReportingChart","Reporting_GraphHolder","App","bang","admin","set","fromJS","toLiteral","exportData","toJSON","importData","fromJSON","getValue","saveData","getItem","shareURL","location","hostname","port","encodeURIComponent","loadData","section","RegExp","exec","decodeURIComponent","getParameterByName","MuiThemeProvider_default","Tabs","initialSelectedIndex","Team_TeamChart","Reporting_ReportingChart","Leaders_Leaders","Admin_Admin","Stats_Stats","textareaStyle","fontFamily","fontSize","lineHeight","ReactDOM","render","App_App","document","getElementById"],"mappings":"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","file":"static/js/main.c3a557e9.chunk.js","sourcesContent":["import URL from 'url-parse'\r\n\r\nimport Couch from \"davenport\";\r\n\r\nexport const STREAM = {\r\n    ENGINEERING: 'ENGINEERING',\r\n    OPERATIONS: 'OPERATIONS',\r\n    PRODUCT: 'PRODUCT',\r\n    PORTFOLIO: 'PORTFOLIO',\r\n    DATA: 'DATA',\r\n    DESIGN: 'DESIGN',\r\n}\r\n\r\nexport const KIND = {\r\n    EMPLOYEE: 'EMPLOYEE',\r\n    DEPARTMENT: 'DEPARTMENT',\r\n    TRIBE: 'TRIBE',\r\n    SQUAD: 'SQUAD',\r\n    TEAM: 'TEAM',\r\n    UNIT: 'UNIT'\r\n}\r\n\r\nexport const TYPE = {\r\n    EMPLOYEE: 'EMPLOYEE',\r\n    TEMP: 'TEMP',\r\n    CONTRACTOR: 'CONTRACTOR',\r\n    AGENCY_CONTRACTOR: 'AGENCY_CONTRACTOR',\r\n}\r\n\r\nclass Employee {\r\n    constructor(id, name, title, reportsTo, memberOf, stream, number, github, startDate, type) {\r\n        this.id = id\r\n        this.name = name\r\n        this.title = title\r\n        this.reportsTo = reportsTo\r\n        this.memberOf = memberOf\r\n        this.stream = stream\r\n        this.number = number\r\n        this.github = github\r\n        this.startDate = startDate || \"\"\r\n        this.type = type || TYPE.EMPLOYEE\r\n    }\r\n}\r\n\r\nclass Team {\r\n    constructor(id, name, kind, parent, vacancies, techLead, productLead, description, backfills) {\r\n        this.id = id\r\n        this.name = name\r\n        this.kind = kind\r\n        this.parent = parent\r\n        this.vacancies = vacancies || {}\r\n        this.backfills = backfills || {}\r\n        this.techLead = techLead\r\n        this.productLead = productLead\r\n        this.description = description\r\n    }\r\n}\r\n\r\nclass Organisation {\r\n    constructor(employees, teams) {\r\n        this.employees = employees\r\n        this.teams = teams\r\n    }\r\n\r\n    toLiteral() {\r\n        return {\r\n            employees: this.employees.map(e => Object.assign({}, e)).sort((a, b) => {\r\n                if (a.name === b.name) return 0\r\n                return (a.name > b.name) ? 1 : -1\r\n            }),\r\n            teams: this.teamHierarchy(),\r\n            reporting: this.reportingHierarchy(),\r\n            rootEmployee: this.rootEmployee,\r\n        }\r\n    }\r\n\r\n    teamsById() {\r\n        const byId = {}\r\n\r\n        this.teams.forEach(t => {\r\n            byId[t.id] = t;\r\n        })\r\n\r\n        return byId\r\n    }\r\n\r\n    reportingHierarchy() {\r\n\r\n        const root = this.rootEmployee;\r\n\r\n        const teamsById = {}\r\n\r\n        this.teams.forEach(t => {\r\n            teamsById[t.id] = t\r\n        })\r\n\r\n        const employeesById = {}\r\n\r\n        this.employees.forEach(e => {\r\n            const employee = Object.assign({}, e)\r\n            employee.children = []\r\n            employeesById[e.id] = employee\r\n\r\n            if (!employee.memberOf) { //no team assoc\r\n                employee.reportsTo = root\r\n                return\r\n            }\r\n\r\n            if (!employee.reportsTo) {\r\n                let team = teamsById[employee.memberOf]\r\n\r\n                if (team.techLead === employee.id || team.productLead === employee.id) {\r\n                    team = teamsById[team.parent]\r\n                }\r\n\r\n                if (!team) {\r\n                    employee.reportsTo = root\r\n                } else {\r\n                    employee.reportsTo = findLeadUpFromFor(team, teamsById, employee) || root\r\n                }\r\n            }\r\n        })\r\n\r\n        Object.values(employeesById).forEach(employee => {\r\n            if (employee.id === root) return;\r\n\r\n            const lead = employeesById[employee.reportsTo]\r\n\r\n            lead.children.push(employee)\r\n        })\r\n\r\n        return employeesById[root]\r\n\r\n    }\r\n\r\n    teamHierarchy() {\r\n        const hierarchy = {}\r\n        this.teams.forEach(t => {\r\n            hierarchy[t.id] = Object.assign({}, t)\r\n            hierarchy[t.id].children = []\r\n            hierarchy[t.id].members = []\r\n        })\r\n\r\n        const root = this.teams.filter(t => !t.parent)\r\n\r\n        if (root.length === 0) {\r\n            return null\r\n            //throw new Error(\"Error while building team hierarchy, no root.\")\r\n        }\r\n\r\n        if (root.length > 1) {\r\n            throw new Error(`Error while building team hierarchy, more than one root defined [${root.map(t => t.id).join(', ')}].`)\r\n        }\r\n\r\n        const employeesById = {}\r\n\r\n        this.employees.forEach(e => {\r\n            employeesById[e.id] = e\r\n        })\r\n\r\n        const rootTeam = hierarchy[root[0].id]\r\n\r\n        this.teams.forEach(t => {\r\n            if (t.parent) {\r\n\r\n                if (!hierarchy[t.parent]) {\r\n                    throw new Error(`Error while building team hierarchy, parent ${t.parent} not found for team ${t.name}`)\r\n                }\r\n\r\n                hierarchy[t.parent].children.push(hierarchy[t.id])\r\n            }\r\n\r\n            if (t.techLead && employeesById[t.techLead]) {\r\n                hierarchy[t.id].techLead = Object.assign({}, employeesById[t.techLead])\r\n            }\r\n\r\n            if (t.productLead && employeesById[t.productLead]) {\r\n                hierarchy[t.id].productLead = Object.assign({}, employeesById[t.productLead])\r\n            }\r\n\r\n        })\r\n\r\n        this.employees.forEach(e => {\r\n\r\n            if (e.memberOf) {\r\n\r\n                if (!hierarchy[e.memberOf]) {\r\n                    throw new Error(`Error while building team hierarchy, team ${e.memberOf} not found for employee ${e.name}`)\r\n                }\r\n\r\n                hierarchy[e.memberOf].members.push(Object.assign({}, e))\r\n            }\r\n        })\r\n\r\n        return rootTeam\r\n    }\r\n\r\n    reparentTeam(team, to) {\r\n        this.teams.find(t => t.id === team).parent = to\r\n    }\r\n\r\n    removeFromTeam(employee) {\r\n        this.employees.find(e => e.id === employee).memberOf = null\r\n    }\r\n\r\n    addToTeam(employee, team) {\r\n        this.employees.find(e => e.id === employee).memberOf = team\r\n    }\r\n\r\n    toJSON() {\r\n        return JSON.stringify({\r\n            employees: this.employees.sort((a, b) => {\r\n                if (a.name === b.name) return 0\r\n                return (a.name > b.name) ? 1 : -1\r\n            }),\r\n            teams: this.teams.sort((a, b) => {\r\n                if (a.name === b.name) return 0\r\n                return (a.name > b.name) ? 1 : -1\r\n            }),\r\n            rootEmployee: this.rootEmployee,\r\n        }, null, 2)\r\n    }\r\n\r\n    fromJSON(jsonString) {\r\n\r\n        try {\r\n\r\n            const data = JSON.parse(jsonString)\r\n\r\n            this.parseData(data)\r\n\r\n        } catch(err) {\r\n            alert(\"JSON.parse error, check console\")\r\n        }\r\n    }\r\n\r\n    parseData(data) {\r\n        this.employees = data.employees.map(e => Object.assign(new Employee(), e))\r\n        this.teams = data.teams.map(e => Object.assign(new Team(), e))\r\n\r\n        this.rootEmployee = data.rootEmployee || \"damon_petta\";\r\n\r\n    }\r\n\r\n    changeHeadcount(team, stream, headcount) {\r\n        headcount = parseInt(headcount, 10)\r\n        if (isNaN(headcount)) {\r\n            headcount = undefined\r\n        }\r\n        this.teams.find(t => t.id === team).vacancies[stream] = headcount\r\n    }\r\n\r\n    changeBackfills(team, stream, headcount) {\r\n        headcount = parseInt(headcount, 10)\r\n        if (isNaN(headcount)) {\r\n            headcount = undefined\r\n        }\r\n        this.teams.find(t => t.id === team).backfills[stream] = headcount\r\n    }\r\n\r\n    addNewTeam(name, kind, parent, description) {\r\n        this.teams.push(new Team(makeTeamId(name, kind), name, kind, parent, undefined, undefined, undefined, description))\r\n    }\r\n\r\n    changeTeamName(team, newName) {\r\n        this.teams.find(t => t.id === team).name = newName\r\n    }\r\n\r\n    changeTeamDescription(team, newDescription) {\r\n        this.teams.find(t => t.id === team).description = newDescription\r\n    }\r\n\r\n    async saveData(url) {\r\n\r\n        const parsedURL = new URL(url);\r\n\r\n        if (!parsedURL.protocol.startsWith(\"couch\")) {\r\n            alert(\"Unsupported storage, try couchdb://\")\r\n            return\r\n        }\r\n\r\n        if (parsedURL.protocol.startsWith(\"couchdbs\")) {\r\n            parsedURL.protocol = \"https:\"\r\n        } else {\r\n            parsedURL.protocol = \"http:\"\r\n        }\r\n\r\n        const couch = new Couch(parsedURL.protocol+\"//\"+parsedURL.host, parsedURL.pathname.substr(1))\r\n\r\n        await couch.put(\r\n            \"chart\",\r\n            {employees: this.employees, teams: this.teams},\r\n            this.documentRevision,\r\n        )\r\n        .then(res => {\r\n            this.documentRevision  = res.rev\r\n        })\r\n        .catch(err => {\r\n            alert(\"failed to save data: \" + err.message)\r\n        })\r\n    }\r\n\r\n    async loadData(url) {\r\n\r\n        try {\r\n\r\n            const parsedURL = new URL(url);\r\n\r\n            let data;\r\n            let dataURL;\r\n            let persistURL = undefined;\r\n\r\n            // couchdb://user:pass@0.0.0.0:5984/it-org-chart\r\n\r\n            if (parsedURL.protocol.startsWith(\"couch\")) {\r\n                // couch URL\r\n\r\n                persistURL = url\r\n\r\n                const loadURL = new URL(url);\r\n\r\n                loadURL.auth = \"\"\r\n                loadURL.password = \"\"\r\n                loadURL.username = \"\"\r\n\r\n                dataURL = loadURL.toString()\r\n\r\n\r\n                if (parsedURL.protocol.startsWith(\"couchdbs\")) {\r\n                    parsedURL.protocol = \"https:\"\r\n                } else {\r\n                    parsedURL.protocol = \"http:\"\r\n                }\r\n\r\n                const couch = new Couch(parsedURL.protocol+\"//\"+parsedURL.host, parsedURL.pathname.substr(1))\r\n\r\n                data = await couch.get(\"chart\").then(data => {\r\n                    this.documentRevision = data._rev\r\n                    return {employees: [], teams: [], ...data}\r\n                }).catch(err => {\r\n                    alert(\"failed to load data: \" + err.message)\r\n                    return data = {\"employees\": [], \"teams\": []}\r\n                })\r\n\r\n\r\n            } else {\r\n                const response = await fetch(url)\r\n                data = await response.json()\r\n\r\n                dataURL = url\r\n            }\r\n\r\n            localStorage.setItem(\"dataURL\", dataURL)\r\n            localStorage.setItem(\"persistURL\", persistURL)\r\n\r\n            return this.parseData(data)\r\n\r\n        } catch(err) {\r\n            alert(\"failed to load: \" + err.message)\r\n        }\r\n\r\n    }\r\n\r\n    removeTeam(team) {\r\n        const teamToRemove = this.teams.find(t => t.id === team)\r\n\r\n        this.employees.forEach(e => {\r\n            if (e.memberOf === team) {\r\n                e.memberOf = undefined\r\n            }\r\n        })\r\n\r\n        const parentTeamId = teamToRemove.parent\r\n\r\n        this.teams.forEach(e => {\r\n            if (e.parent === team) {\r\n                e.parent = parentTeamId\r\n            }\r\n        })\r\n\r\n        this.teams = this.teams.filter(t => t.id !== team)\r\n    }\r\n\r\n    addEmployee(name, title, stream, reportsTo, employee, github, startDate, type) {\r\n        this.employees.push(new Employee(makeEmployeeId(name), name, title, reportsTo, undefined, stream, employee, github, startDate === \"\" ? null : startDate, type))\r\n    }\r\n\r\n    editEmployee(id, name, title, stream, reportsTo, employeeNumber, github, startDate, type) {\r\n        const employee = this.employees.find(e => e.id === id)\r\n\r\n        employee.name = name\r\n        employee.title = title\r\n        employee.stream = stream\r\n        employee.reportsTo = reportsTo\r\n        employee.number = employeeNumber\r\n        employee.github = github\r\n        employee.startDate = startDate === \"\" ? null : startDate\r\n        employee.type = type\r\n\r\n    }\r\n\r\n    removeEmployee(id) {\r\n\r\n        this.employees.filter(e => e.reportsTo === id).forEach(e => {\r\n            e.reportsTo = undefined\r\n        })\r\n\r\n        this.teams.filter(t => t.techLead === id).forEach(t => {\r\n            t.techLead = undefined\r\n        })\r\n\r\n        this.teams.filter(t => t.productLead === id).forEach(t => {\r\n            t.productLead = undefined\r\n        })\r\n\r\n        this.employees = this.employees.filter(e => e.id !== id)\r\n    }\r\n\r\n    setTechLead(team, lead) {\r\n        this.teams.find(t => t.id === team).techLead = lead\r\n    }\r\n\r\n    setProductLead(team, lead) {\r\n        this.teams.find(t => t.id === team).productLead = lead\r\n    }\r\n}\r\n\r\nfunction makeTeamId(name, kind) {\r\n    return `${name}_${kind}`.toLowerCase().replace(/[^a-z0-9]+/, '_')\r\n}\r\n\r\nfunction makeEmployeeId(name) {\r\n    return `${name}`.toLowerCase().replace(/[^a-z0-9]+/, '_')\r\n}\r\n\r\nconst data = new Organisation([],[])\r\n\r\nif (process.env.NODE_ENV === \"development\") {\r\n    const d = require(\"./fixtures/example.json\")\r\n    data.parseData(d)\r\n}\r\n\r\nexport default data\r\n\r\nexport function _moveNodesToChildren(team, showMembers, showVacancies, notRecursive) {\r\n\r\n    if (!notRecursive) {\r\n        team.children = team.children.map(c => _moveNodesToChildren(c, showMembers, showVacancies))\r\n    }\r\n\r\n    if (showMembers) {\r\n        team.children = team.children.concat(team.members)\r\n    }\r\n\r\n    if (showVacancies) {\r\n        for (let stream in team.vacancies) {\r\n            for (let n = 1; n <=team.vacancies[stream]; n++) {\r\n                team.children.push({\r\n                    name: `${stream}`,\r\n                    kind: 'vacancy',\r\n                    id: `vacancy_${team.id}_${stream}_${n}`\r\n                })\r\n            }\r\n        }\r\n        for (let stream in team.backfills) {\r\n            for (let n = 1; n <=team.backfills[stream]; n++) {\r\n                team.children.push({\r\n                    name: `${stream}`,\r\n                    kind: 'backfill',\r\n                    id: `backfill_${team.id}_${stream}_${n}`\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    return team\r\n}\r\n\r\nconst findLeadUpFromFor = (team, teams, employee) => {\r\n\r\n    let searchKey\r\n\r\n    switch (employee.stream) {\r\n        case STREAM.PRODUCT:\r\n        case STREAM.DESIGN:\r\n        case STREAM.DATA:\r\n            searchKey = 'productLead'\r\n            break;\r\n        case STREAM.ENGINEERING:\r\n        case STREAM.OPERATIONS:\r\n            searchKey = 'techLead'\r\n            break;\r\n        default:\r\n            searchKey = 'techLead'\r\n    }\r\n\r\n    let currentTeam = team\r\n\r\n    if (currentTeam[searchKey]) {\r\n        return currentTeam[searchKey]\r\n    }\r\n\r\n    while(currentTeam.parent && teams[currentTeam.parent]) {\r\n        currentTeam = teams[currentTeam.parent]\r\n\r\n        if (currentTeam[searchKey]) {\r\n            return currentTeam[searchKey]\r\n        }\r\n    }\r\n\r\n    return null\r\n}\r\n\r\nexport const flattenTeamHierarchyExcluding = (teamId) => {\r\n    function fn(r, a) {\r\n\r\n        if (a.id === teamId) return r\r\n\r\n        r.push(a);\r\n        if (a.children && a.children.length > 0) {\r\n            a.children.reduce(fn, r);\r\n        }\r\n        return r;\r\n    }\r\n\r\n    return fn\r\n}\r\n","import React from 'react'\r\n\r\nimport {Box, Flex} from 'reflexbox'\r\nimport {List, ListItem} from 'material-ui/List'\r\nimport {CardHeader} from 'material-ui/Card'\r\nimport Subheader from 'material-ui/Subheader';\r\nimport SelectField from 'material-ui/SelectField';\r\nimport MenuItem from 'material-ui/MenuItem';\r\nimport TextField from 'material-ui/TextField';\r\nimport Checkbox from 'material-ui/Checkbox';\r\nimport {RadioButton, RadioButtonGroup} from 'material-ui/RadioButton';\r\nimport RaisedButtom from 'material-ui/RaisedButton'\r\nimport FlatButton from 'material-ui/FlatButton'\r\nimport Dialog from 'material-ui/Dialog';\r\nimport IconButton from 'material-ui/IconButton';\r\nimport EditIcon from 'material-ui/svg-icons/editor/mode-edit';\r\n\r\nimport {flattenTeamHierarchyExcluding, KIND, STREAM, TYPE} from './state'\r\n\r\n\r\nfunction debounce(func, wait, immediate) {\r\n    var timeout;\r\n    return function () {\r\n        var context = this, args = arguments;\r\n        var later = function () {\r\n            timeout = null;\r\n            if (!immediate) func.apply(context, args);\r\n        };\r\n        var callNow = immediate && !timeout;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n        if (callNow) func.apply(context, args);\r\n    };\r\n};\r\n\r\nexport default class Admin extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n\r\n        this.state = {\r\n            team: null\r\n        }\r\n    }\r\n\r\n    componentWillReceiveProps(props) {\r\n        if (!this.state.team) {\r\n            return\r\n        }\r\n\r\n        const teams = [props.data.get('teams').toJS()].reduce(flattenTeamHierarchyExcluding(), [])\r\n\r\n        this.setState({team: teams.find(t => t.id === this.state.team.id)})\r\n    }\r\n\r\n    render() {\r\n\r\n        if (!this.props.data.get('teams')) {\r\n            return null\r\n        }\r\n\r\n        return (\r\n            <Flex p={0} align='center'>\r\n                <Box pb={0} w={1 / 3} style={{alignSelf: \"flex-start\"}}>\r\n                    <TeamManager team={this.props.data.get('teams').toJS()} onSelect={(team) => {\r\n                        this.setState({\r\n                            team\r\n                        })\r\n                    }} addNewTeam={this.props.actions.addNewTeam}/>\r\n                </Box>\r\n                <Box pb={0} w={1 / 3} style={{alignSelf: \"flex-start\"}}>\r\n                    <TeamDetails root={this.props.data.get('teams').toJS()} team={this.state.team}\r\n                                 {...this.props.actions}\r\n                                 employees={this.props.data.get('employees').toJS()}\r\n                    />\r\n                </Box>\r\n                <Box pb={0} w={1 / 3} style={{alignSelf: \"flex-start\", maxHeight: \"90vh\", overflow: \"auto\"}}>\r\n                    <EmployeeList\r\n                        employees={this.props.data.get('employees').toJS()}\r\n                        exclude={this.state.team ? this.state.team.id : null} addToTeam={(employee) => {\r\n                            this.props.actions.addToTeam(employee, this.state.team.id)\r\n                        }}\r\n                        teams={[this.props.data.get('teams').toJS()].reduce(flattenTeamHierarchyExcluding(), [])}\r\n                        addEmployee={this.props.actions.addEmployee}\r\n                        editEmployee={this.props.actions.editEmployee}\r\n                        removeEmployee={this.props.actions.removeEmployee}\r\n                    />\r\n                </Box>\r\n            </Flex>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nfunction collectUpstreamEmployees(collection, team) {\r\n\r\n    if (team.members) {\r\n        collection = collection.concat(team.members);\r\n    }\r\n\r\n    if (team.parent) {\r\n        collection = collectUpstreamEmployees(collection, team.parent)\r\n    }\r\n\r\n    return collection\r\n}\r\n\r\n\r\nclass TeamDetails extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            name: \"\"\r\n        }\r\n\r\n        this.debouncedChangeTeamName = debounce(props.changeTeamName, 500, false)\r\n        this.debouncedChangeTeamDescription = debounce(props.changeTeamDescription, 500, false)\r\n    }\r\n\r\n    componentWillReceiveProps(props) {\r\n        this.setState({\r\n            name: props.team ? props.team.name : \"\",\r\n            description: props.team && props.team.description ? props.team.description : \"\"\r\n        })\r\n    }\r\n\r\n    onNameChange = (id, val) => {\r\n        this.setState({\r\n            name: val\r\n        })\r\n\r\n        this.debouncedChangeTeamName(id, val)\r\n    }\r\n\r\n    onDescriptionChange = (id, val) => {\r\n        this.setState({\r\n            description: val\r\n        })\r\n\r\n        this.debouncedChangeTeamDescription(id, val)\r\n    }\r\n\r\n    render() {\r\n        let {root, team, reparentTeam, removeFromTeam, changeHeadcount, changeBackfills, removeTeam, employees, setProductLead, setTechLead} = this.props\r\n\r\n        if (!team) {\r\n            return null\r\n        }\r\n\r\n        let upstreamEmlpoyeesStreams = [...new Set(collectUpstreamEmployees([], team).map(e => e.stream))].sort()\r\n\r\n        if (upstreamEmlpoyeesStreams.indexOf(STREAM.PORTFOLIO) !== -1) {\r\n            upstreamEmlpoyeesStreams = [STREAM.PORTFOLIO]\r\n        } else if (upstreamEmlpoyeesStreams.indexOf(STREAM.OPERATIONS) !== -1) {\r\n            upstreamEmlpoyeesStreams = [STREAM.OPERATIONS]\r\n        } else {\r\n            upstreamEmlpoyeesStreams = [STREAM.ENGINEERING, STREAM.PRODUCT, STREAM.DATA, STREAM.DESIGN]\r\n        }\r\n\r\n        return (\r\n\r\n            <div>\r\n                <TextField\r\n                    value={this.state.name}\r\n                    floatingLabelText={\"Name\"}\r\n                    fullWidth={true}\r\n                    onChange={(_, val) => {\r\n                        this.onNameChange(team.id, val)\r\n                    }}\r\n                />\r\n\r\n\r\n                <SelectField\r\n                    floatingLabelText=\"Member of\"\r\n                    fullWidth={true}\r\n                    value={team.parent}\r\n                    onChange={(_, __, i) => reparentTeam(team.id, i)}\r\n                >\r\n                    {[root].reduce(flattenTeamHierarchyExcluding(team.id), []).map(t => (\r\n                        <MenuItem key={t.id} value={t.id} primaryText={t.name}/>\r\n                    ))}\r\n                </SelectField>\r\n\r\n                <CardHeader title={\"Vacancies\"}/>\r\n\r\n                <Flex p={0}>\r\n                    {[...new Set(Object.keys(team.vacancies).concat(upstreamEmlpoyeesStreams))].sort().map(s => (\r\n                        <Box pb={0} w={1 / 4} style={{alignSelf: \"flex-start\"}} key={`vacancies_${s}`}>\r\n                            <TextField onChange={(_, val) => changeHeadcount(team.id, s, val)}\r\n                                       floatingLabelText={s.toLowerCase()}\r\n                                       value={team.vacancies[s] !== undefined ? team.vacancies[s] : \"\"}/>\r\n                        </Box>\r\n                    ))}\r\n                </Flex>\r\n\r\n                <CardHeader title={\"Backfills\"}/>\r\n\r\n                <Flex p={0}>\r\n                    {[...new Set(Object.keys(team.vacancies).concat(upstreamEmlpoyeesStreams))].sort().map(s => (\r\n                        <Box pb={0} w={1 / 4} style={{alignSelf: \"flex-start\"}} key={`backfills_${s}`}>\r\n                            <TextField onChange={(_, val) => changeBackfills(team.id, s, val)}\r\n                                       floatingLabelText={s.toLowerCase()}\r\n                                       value={team.backfills[s] !== undefined ? team.backfills[s] : \"\"}/>\r\n                        </Box>\r\n                    ))}\r\n                </Flex>\r\n\r\n\r\n                <SelectField\r\n                    floatingLabelText=\"Tech lead\"\r\n                    fullWidth={true}\r\n                    value={team.techLead ? team.techLead.id : null}\r\n                    onChange={(_, __, i) => setTechLead(team.id, i)}\r\n                >\r\n                    <MenuItem value={null} primaryText=\"\" />\r\n                    {employees.map(t => (\r\n                        <MenuItem key={t.id} value={t.id} primaryText={t.name}/>\r\n                    ))}\r\n                </SelectField>\r\n\r\n                <SelectField\r\n                    floatingLabelText=\"Product lead\"\r\n                    fullWidth={true}\r\n                    value={team.productLead ? team.productLead.id : null}\r\n                    onChange={(_, __, i) => setProductLead(team.id, i)}\r\n                >\r\n                    <MenuItem value={null} primaryText=\"\" />\r\n                    {employees.filter(e => e.stream === STREAM.PRODUCT).map(t => (\r\n                        <MenuItem key={t.id} value={t.id} primaryText={t.name}/>\r\n                    ))}\r\n                </SelectField>\r\n\r\n                <Subheader>Members</Subheader>\r\n                <List>\r\n\r\n                    {team.members.map(e => (\r\n                        <ListItem onClick={() => removeFromTeam(e.id)} primaryText={e.name} key={e.id}\r\n                                  secondaryText={e.title}/>\r\n                    ))}\r\n                </List>\r\n                <TextField\r\n                    value={this.state.description}\r\n                    floatingLabelText={\"Description\"}\r\n                    fullWidth={true}\r\n                    multiLine={true}\r\n                    rowsMax={6}\r\n                    rows={3}\r\n                    onChange={(_, val) => {\r\n                        this.onDescriptionChange(team.id, val)\r\n                    }}\r\n                />\r\n                <RaisedButtom fullWidth={true} label={\"Delete\"} secondary onClick={() => {\r\n                    if (!window.confirm(\"Ya?\\nAll employees who are part of this team will be unassigned.\\nAll child teams will be assigned to parent.\")) {\r\n                        return\r\n                    }\r\n                    removeTeam(team.id)\r\n                }}/>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst TeamManager = ({team, onSelect, addNewTeam}) => (\r\n    <List>\r\n        <ListItem onClick={() => onSelect(team)} primaryTogglesNestedList={false} initiallyOpen={true}\r\n                  primaryText={team.name} key={team.id}\r\n                  nestedItems={renderTeams(team.children, onSelect)}/>\r\n        <ListItem>\r\n            <AddTeamDialog parents={[team].reduce(flattenTeamHierarchyExcluding(), [])} addNewTeam={addNewTeam}/>\r\n        </ListItem>\r\n    </List>\r\n)\r\n\r\nconst renderTeams = (teams, onSelect) => {\r\n    if (!teams) {\r\n        return null\r\n    }\r\n    return teams.map(t => (\r\n        <ListItem onClick={() => onSelect(t)} primaryTogglesNestedList={true} primaryText={t.name} key={t.id}\r\n                  nestedItems={renderTeams(t.children, onSelect)}/>\r\n    ))\r\n}\r\n\r\nclass EmployeeList extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            search: \"\",\r\n            filter: false,\r\n            addPersonOpen: false,\r\n            editedPerson: null\r\n        }\r\n    }\r\n\r\n    handleSearchChange = (event) => {\r\n        this.setState({\r\n            search: event.target.value,\r\n        });\r\n    };\r\n\r\n    handleFilterChange = (_, isInputChecked) => {\r\n        this.setState({\r\n            filter: isInputChecked,\r\n        });\r\n    };\r\n\r\n\r\n    render() {\r\n        const {employees, exclude, addToTeam, teams} = this.props\r\n        return (\r\n            <div>\r\n                <List style={{maxHeight: '100%', overflow: 'auto'}}>\r\n                    <ListItem>\r\n                        <RaisedButtom label={\"Add\"} fullWidth={true} onClick={() => {\r\n                            this.setState({addPersonOpen: true, editedPerson: null})\r\n                        }}/>\r\n                        <TextField\r\n                            fullWidth={true}\r\n                            hintText=\"Search\"\r\n                            value={this.state.search}\r\n                            onChange={this.handleSearchChange}\r\n                        />\r\n                        <Checkbox\r\n                            label=\"unassigned only\"\r\n                            onCheck={this.handleFilterChange}\r\n                        />\r\n                    </ListItem>\r\n                    {employees.filter(e => {\r\n                        return e.memberOf !== exclude &&\r\n                            e.name.toLowerCase().search(this.state.search.toLowerCase()) !== -1 &&\r\n                            (!this.state.filter || !e.memberOf)\r\n                    }).map(e => {\r\n                        const team = teams.find(t => t.id === e.memberOf)\r\n\r\n                        let sub = e.title\r\n\r\n                        if (e.github) {\r\n                            sub = `${sub} [gh: ${e.github}]`\r\n                        }\r\n\r\n                        if (team) {\r\n                            sub = `${sub} - ${team.name}`\r\n                        }\r\n\r\n                        if (e.type === \"TEMP\") {\r\n                            sub = `[TMP] ${sub}`\r\n                        }\r\n\r\n                        if (e.type === \"CONTRACTOR\") {\r\n                            sub = `[CON] ${sub}`\r\n                        }\r\n\r\n                        if (e.type === \"AGENCY_CONTRACTOR\") {\r\n                            sub = `[AGN] ${sub}`\r\n                        }\r\n\r\n                        if (e.startDate) {\r\n                            sub = `${e.startDate} - ${sub}`\r\n                        }\r\n\r\n                        return (<ListItem primaryText={e.name + ` #${e.number}`} key={e.id} onClick={() => exclude && addToTeam(e.id)}\r\n                                          secondaryText={sub}\r\n                                          rightIconButton={<IconButton tooltip=\"edit\" onClick={() => {\r\n                                              this.setState({addPersonOpen: true, editedPerson: e})\r\n                                          }}><EditIcon/></IconButton>}/>)\r\n                    })}\r\n                </List>\r\n                <AddPersonDialog open={this.state.addPersonOpen} person={this.state.editedPerson} afterClose={() => {\r\n                    this.setState({addPersonOpen: false, editedPerson: null} )\r\n                }} addEmployee={this.props.addEmployee} editEmployee={this.props.editEmployee} removeEmployee={this.props.removeEmployee} employees={employees} />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nclass AddPersonDialog extends React.Component {\r\n\r\n    state = {\r\n        open: false,\r\n        id: null,\r\n        name: \"\",\r\n        title: \"\",\r\n        stream: STREAM.ENGINEERING,\r\n        reportsTo: null,\r\n        github: \"\",\r\n        number: \"\",\r\n        type: TYPE.EMPLOYEE,\r\n        startDate: \"\",\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps) {\r\n        if (this.props === nextProps) {\r\n            return\r\n        }\r\n\r\n        this.setState({\r\n            open: nextProps.open,\r\n            id: null,\r\n            name: \"\",\r\n            title: \"\",\r\n            github: \"\",\r\n            number: \"\",\r\n            stream: STREAM.ENGINEERING,\r\n            reportsTo: null,\r\n            type: TYPE.EMPLOYEE,\r\n            startDate: \"\",\r\n            ...nextProps.person,\r\n        })\r\n\r\n    }\r\n\r\n    handleClose = () => {\r\n        //this.setState({open: false});\r\n        this.props.afterClose()\r\n    };\r\n\r\n    submit = () => {\r\n        const {id, name, title, stream, reportsTo, number, github, type, startDate} = this.state\r\n\r\n        if (!name || !title || !stream || !type) {\r\n            return\r\n        }\r\n\r\n        if (id) {\r\n            this.props.editEmployee(id, name, title, stream, reportsTo, number, github, startDate, type);\r\n        } else {\r\n            this.props.addEmployee(name, title, stream, reportsTo, number, github, startDate, type);\r\n        }\r\n\r\n        this.handleClose()\r\n    }\r\n\r\n    delete = () => {\r\n\r\n        const {id} = this.state\r\n\r\n        if (!id) {\r\n            return this.handleClose()\r\n        }\r\n\r\n        const go = window.confirm(\"Really, but like... really really?\")\r\n\r\n        if (go) {\r\n            this.props.removeEmployee(id)\r\n        }\r\n\r\n        return this.handleClose()\r\n\r\n    }\r\n\r\n    render() {\r\n        const actions = [\r\n            <FlatButton\r\n                label=\"Cancel\"\r\n                primary={true}\r\n                onClick={this.handleClose}\r\n            />,\r\n            <RaisedButtom\r\n                label=\"Submit\"\r\n                primary={true}\r\n                onClick={this.submit}\r\n            />,\r\n        ];\r\n\r\n        return (\r\n            <Dialog\r\n                title={this.props.person ? \"Edit Employee\" : \"Add New Employee\"}\r\n                actions={actions}\r\n                modal={false}\r\n                open={this.state.open}\r\n                onRequestClose={this.handleClose}\r\n            >\r\n\r\n                <TextField floatingLabelText={\"Full Name\"} onChange={(_, val) => {\r\n                    this.setState({name: val})\r\n                }} value={this.state.name}/><br/>\r\n\r\n                <TextField floatingLabelText={\"Title\"} onChange={(_, val) => {\r\n                    this.setState({title: val})\r\n                }} value={this.state.title}/><br/>\r\n\r\n                <TextField floatingLabelText={\"Start Date\"} onChange={(_, val) => {\r\n                    this.setState({startDate: val})\r\n                }} value={this.state.startDate}/><br/>\r\n\r\n                <TextField floatingLabelText={\"GitHub\"} onChange={(_, val) => {\r\n                    this.setState({github: val})\r\n                }} value={this.state.github}/><br/>\r\n\r\n                <TextField floatingLabelText={\"Employee #\"} onChange={(_, val) => {\r\n                    this.setState({number: val})\r\n                }} value={this.state.number}/><br/>\r\n\r\n                <SelectField\r\n                    onChange={(_, __, val) => {\r\n                        this.setState({stream: val})\r\n                    }}\r\n                    fullWidth={true}\r\n                    value={this.state.stream}\r\n                    floatingLabelText={\"Stream\"}\r\n\r\n                >\r\n\r\n                    <MenuItem key={STREAM.ENGINEERING} value={STREAM.ENGINEERING} primaryText={STREAM.ENGINEERING}/>\r\n                    <MenuItem key={STREAM.PRODUCT} value={STREAM.PRODUCT} primaryText={STREAM.PRODUCT}/>\r\n                    <MenuItem key={STREAM.DATA} value={STREAM.DATA} primaryText={STREAM.DATA}/>\r\n                    <MenuItem key={STREAM.DESIGN} value={STREAM.DESIGN} primaryText={STREAM.DESIGN}/>\r\n                    <MenuItem key={STREAM.OPERATIONS} value={STREAM.OPERATIONS} primaryText={STREAM.OPERATIONS}/>\r\n                    <MenuItem key={STREAM.PORTFOLIO} value={STREAM.PORTFOLIO} primaryText={STREAM.PORTFOLIO}/>\r\n\r\n                </SelectField>\r\n\r\n\r\n                <SelectField\r\n                    onChange={(_, __, val) => {\r\n                        this.setState({type: val})\r\n                    }}\r\n                    fullWidth={true}\r\n                    value={this.state.type}\r\n                    floatingLabelText={\"Type\"}\r\n                >\r\n\r\n                    <MenuItem key={TYPE.EMPLOYEE} value={TYPE.EMPLOYEE} primaryText={TYPE.EMPLOYEE}/>\r\n                    <MenuItem key={TYPE.CONTRACTOR} value={TYPE.CONTRACTOR} primaryText={TYPE.CONTRACTOR}/>\r\n                    <MenuItem key={TYPE.AGENCY_CONTRACTOR} value={TYPE.AGENCY_CONTRACTOR} primaryText={TYPE.AGENCY_CONTRACTOR}/>\r\n                    <MenuItem key={TYPE.TEMP} value={TYPE.TEMP} primaryText={TYPE.TEMP}/>\r\n\r\n                </SelectField>\r\n\r\n                <SelectField\r\n                    onChange={(_, __, val) => {\r\n                        this.setState({reportsTo: val === \"--inherit--\" ? undefined : val})\r\n                    }}\r\n                    fullWidth={true}\r\n                    value={this.state.reportsTo}\r\n                    floatingLabelText={\"Reports to\"}\r\n                >\r\n                    <MenuItem key={\"_report-none\"} value={\"--inherit--\"} primaryText={\"\"}/>\r\n                    {this.props.employees.map(t => (\r\n                        <MenuItem key={t.id} value={t.id} primaryText={t.name}/>\r\n                    ))}\r\n                </SelectField>\r\n\r\n                <RaisedButtom\r\n                    label=\"DELETE\"\r\n                    secondary={true}\r\n                    onClick={this.delete}\r\n                />\r\n\r\n            </Dialog>\r\n        )\r\n    }\r\n}\r\n\r\nclass AddTeamDialog extends React.Component {\r\n    state = {\r\n        open: false,\r\n        name: \"\",\r\n        kind: KIND.SQUAD,\r\n        parent: \"\"\r\n    };\r\n\r\n    handleOpen = () => {\r\n        this.setState({open: true, name: \"\", kind: KIND.SQUAD, parent: \"\", description: \"\"});\r\n    };\r\n\r\n    handleClose = () => {\r\n        this.setState({open: false});\r\n    };\r\n\r\n    submit = () => {\r\n        const {name, kind, parent, description} = this.state\r\n\r\n        if (!name || !kind || !parent || !description) {\r\n            return\r\n        }\r\n\r\n        this.props.addNewTeam(name, kind, parent, description);\r\n\r\n        this.setState({open: false})\r\n    }\r\n\r\n    render() {\r\n        const actions = [\r\n            <FlatButton\r\n                label=\"Cancel\"\r\n                primary={true}\r\n                onClick={this.handleClose}\r\n            />,\r\n            <RaisedButtom\r\n                label=\"Submit\"\r\n                primary={true}\r\n                onClick={this.submit}\r\n            />,\r\n        ];\r\n\r\n        return (\r\n            <div>\r\n                <RaisedButtom label={\"Add\"} fullWidth={true} onClick={this.handleOpen}/>\r\n                <Dialog\r\n                    title=\"Add New Team\"\r\n                    actions={actions}\r\n                    modal={false}\r\n                    open={this.state.open}\r\n                    onRequestClose={this.handleClose}\r\n                >\r\n                    <TextField floatingLabelText={\"Team name\"} onChange={(_, val) => {\r\n                        this.setState({name: val})\r\n                    }} value={this.state.name}/>\r\n                    <RadioButtonGroup name=\"kind\" onChange={(_, val) => {\r\n                        this.setState({kind: val})\r\n                    }} labelPosition={\"right\"} valueSelected={this.state.kind}>\r\n                        <RadioButton\r\n                            value={KIND.SQUAD}\r\n                            label={KIND.SQUAD}\r\n                        />\r\n                        <RadioButton\r\n                            value={KIND.TRIBE}\r\n                            label={KIND.TRIBE}\r\n                        />\r\n                        <RadioButton\r\n                            value={KIND.TEAM}\r\n                            label={KIND.TEAM}\r\n                        />\r\n                        <RadioButton\r\n                            value={KIND.UNIT}\r\n                            label={KIND.UNIT}\r\n                        />\r\n                    </RadioButtonGroup>\r\n                    <SelectField\r\n                        onChange={(_, __, val) => {\r\n                            this.setState({parent: val})\r\n                        }}\r\n                        fullWidth={true}\r\n                        value={this.state.parent}\r\n                        floatingLabelText={\"Member of\"}\r\n                    >\r\n                        {this.props.parents.map(t => (\r\n                            <MenuItem key={t.id} value={t.id} primaryText={t.name}/>\r\n                        ))}\r\n                    </SelectField>\r\n                    <TextField floatingLabelText={\"Description\"} multiLine={true} rowsMax={6} rows={4}\r\n                        onChange={(_, val) => {\r\n                        this.setState({description: val})\r\n                    }} value={this.state.description}/>\r\n                </Dialog>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import * as d3 from 'd3'\r\n\r\n//d3.select(self.frameElement).style(\"height\", height + \"px\");\r\n\r\nexport default (containerId, vizFactory, name) => {\r\n\r\n    let height = window.innerHeight-100\r\n    let width = window.innerWidth\r\n\r\n    function zoom() {\r\n        viz.attr(\"transform\", d3.event.transform)\r\n    }\r\n\r\n    const container = d3.select(\"#\"+containerId).append('div').classed(\"svg-container\", true)\r\n        .style(\"width\", `${width}px`)\r\n        .style(\"height\", `${height}px`)\r\n        .style(\"background-color\", \"white\");\r\n\r\n    const svg = container.append(\"svg\")\r\n        .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\r\n        //class to make it responsive\r\n        .classed(\"svg-content-responsive\", true)\r\n        .attr(\"width\", \"100%\")\r\n        .attr(\"height\", \"100%\")\r\n\r\n    const vizContainer = svg.append(\"g\")\r\n        .attr(\"transform\", \"translate(\" + width / 2 + \",\" + (height / 2) + \")\")\r\n        .call(d3.zoom().on(\"zoom\", zoom)).on(\"dblclick.zoom\", null)\r\n\r\n    const defs = vizContainer.append('defs')\r\n\r\n    defs.append('pattern')\r\n        .attr('id', 'diagonalHatch')\r\n        .attr('patternUnits', 'userSpaceOnUse')\r\n        .attr('width', 4)\r\n        .attr('height', 4)\r\n        .append('path')\r\n        .attr('shape-rendering', 'cripsEdges')\r\n        .attr('d', 'M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2')\r\n        .attr('stroke', '#000000')\r\n        .attr('stroke-width', 1)\r\n        .attr('opacity', 0.3)\r\n\r\n\r\n    defs.append('pattern')\r\n        .attr('id', 'pattern-stripe')\r\n        .attr('width', 4)\r\n        .attr('height', 4)\r\n        .attr('patternUnits', 'userSpaceOnUse')\r\n        .attr('patternTransform', 'rotate(45)')\r\n        .append('rect')\r\n        .attr('width' ,3)\r\n        .attr('height', 4)\r\n        .attr('transform', 'translate(0,0)')\r\n        .attr('fill', 'gray')\r\n\r\n\r\n    defs.append('mask')\r\n        .attr('id', 'diagonalHatchMask')\r\n        .append('rect')\r\n        .attr('x', 0)\r\n        .attr('y', 0)\r\n        .attr('width', '100%')\r\n        .attr('height', '100%')\r\n        .attr('fill', 'url(#smallDot)')\r\n\r\n\r\n    defs.append('pattern')\r\n        .attr('id', 'smallDotColor')\r\n        .attr('patternUnits', 'userSpaceOnUse')\r\n        .attr('width', 4)\r\n        .attr('height', 4)\r\n        .append('image')\r\n        .attr('href', \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1JyBoZWlnaHQ9JzUnPgo8cmVjdCB3aWR0aD0nNScgaGVpZ2h0PSc1JyBmaWxsPScjZmZmJy8+CjxyZWN0IHdpZHRoPScxJyBoZWlnaHQ9JzEnIGZpbGw9JyNjY2MnLz4KPC9zdmc+\")\r\n        .attr('x', 0)\r\n        .attr('y', 0)\r\n\r\n    defs.append('pattern')\r\n        .attr('id', 'smallDot')\r\n        .attr('patternUnits', 'userSpaceOnUse')\r\n        .attr('width', 4)\r\n        .attr('height', 4)\r\n        .append('image')\r\n        .attr('href', \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1JyBoZWlnaHQ9JzUnPgo8cmVjdCB3aWR0aD0nNScgaGVpZ2h0PSc1JyBmaWxsPScjZmZmJy8+CjxyZWN0IHdpZHRoPScxJyBoZWlnaHQ9JzEnIGZpbGw9JyNjY2MnLz4KPC9zdmc+\")\r\n        .attr('x', 0)\r\n        .attr('y', 0)\r\n\r\n    const viz = vizContainer.append(\"g\").attr(\"class\", \"graph\")\r\n        .attr(\"width\", \"100%\")\r\n        .attr(\"height\", \"100%\")\r\n\r\n\r\n    viz.selectAll(\"*\").remove();\r\n    vizFactory(width, height, name)(viz)\r\n\r\n}\r\n\r\nexport function exportToSVG(containerId) {\r\n    const html = d3.select(`#${containerId} .svg-container svg`)\r\n        .attr(\"version\", 1.1)\r\n        .attr(\"xmlns\", \"http://www.w3.org/2000/svg\")\r\n        .node().parentNode.innerHTML;\r\n\r\n    const blob = new Blob([html], {type: \"image/svg+xml\"});\r\n\r\n    return blob\r\n}\r\n\r\n","import * as d3 from 'd3'\r\n\r\nfunction checkWithinParent(subject, lookForID) {\r\n    let parent = subject.parent\r\n    while(parent) {\r\n        if (lookForID === parent.data.id) {\r\n            return true\r\n        }\r\n        parent = parent.parent\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nexport default (nodes) => {\r\n\r\n    return (width, height, name) => {\r\n\r\n        d3.select(\"svg\").attr(\"title\", name)\r\n\r\n        const radius = (Math.min(width, height) / 2) + 50;\r\n\r\n        const x = d3.scaleLinear()\r\n            .range([0, 2 * Math.PI]);\r\n\r\n        const y = d3.scaleLinear()\r\n            .range([0, radius]);\r\n\r\n        const color = d3.scaleOrdinal(d3.schemeCategory20);\r\n\r\n        const label = (d, always) => {\r\n            if (d.id === 'technology_board') {\r\n                return \"Technology Board\"\r\n            }\r\n            if (d.id === 'product_board') {\r\n                return \"Product Board\"\r\n            }\r\n            if (d.type === 'team') {\r\n                return `${d.name} ${d.group_actual}/${d.group}`\r\n            }\r\n\r\n            if (d.type === \"TEMP\") {\r\n                return \"[TMP] \"+d.name\r\n            }\r\n\r\n            if (d.type === \"CONTRACTOR\") {\r\n                return \"[CON] \"+d.name\r\n            }\r\n\r\n            if (d.type === \"AGENCY_CONTRACTOR\") {\r\n                return \"[AGN] \"+d.name\r\n            }\r\n\r\n            if (d.kind === 'vacancy') {\r\n                return \"[HC] \"+d.name\r\n            }\r\n\r\n            if (d.kind === 'backfill') {\r\n                return \"[BF] \"+d.name\r\n            }\r\n\r\n            if (d.name) {\r\n                return d.name\r\n            }\r\n            return always ? d.title : ''\r\n        }\r\n\r\n        const arc = d3.arc()\r\n            .startAngle(function (d) {\r\n                return Math.max(0, Math.min(2 * Math.PI, x(d.x0)));\r\n            })\r\n            .endAngle(function (d) {\r\n                return Math.max(0, Math.min(2 * Math.PI, x(d.x1)));\r\n            })\r\n            .innerRadius(function (d) {\r\n                return Math.max(0, y(d.y0));\r\n            })\r\n            .outerRadius(function (d) {\r\n                return Math.max(0, y(d.y1));\r\n            });\r\n\r\n        const getAngle = (d) => {\r\n            const thetaDeg = (180 / Math.PI * (arc.startAngle()(d) + arc.endAngle()(d)) / 2 - 90);\r\n            return (thetaDeg > 90) ? thetaDeg - 180 : thetaDeg;\r\n        }\r\n\r\n        const partition = d3.partition();\r\n\r\n        const root = d3.hierarchy(nodes, d => {\r\n            return d.children\r\n        });\r\n\r\n        root.sum(function (d) {\r\n            return d.children && d.children.length > 0 ? 0 : 100\r\n        });\r\n\r\n        return (viz) => {\r\n\r\n            const rotate = {\r\n                start: {\r\n                    x: null,\r\n                    y: null,\r\n                    angle: null\r\n                }\r\n            }\r\n\r\n\r\n\r\n            const path = viz.selectAll(\"path\")\r\n                .data(partition(root).descendants())\r\n                .enter().append(\"g\")\r\n                .attr('transform', 'rotate(0, 0, 0)')\r\n                .call(d3.drag()\r\n                    .filter(() => {\r\n                        return d3.event.shiftKey\r\n                    })\r\n                    .on(\"start\", () => {\r\n                        rotate.start.x = d3.event.x\r\n                        rotate.start.y = d3.event.y\r\n                        const matches = path.attr('transform').match(/rotate\\(([-+]?([0-9]*\\.[0-9]+|[0-9]+)).*/)\r\n                        rotate.start.angle = parseFloat(matches[1])\r\n                    })\r\n                    .on(\"drag\", () => {\r\n                        const rotation = Math.atan2(d3.event.y - rotate.start.y, d3.event.x - rotate.start.x) * 180 / Math.PI;\r\n\r\n                        path.attr('transform', `rotate(${rotate.start.angle + rotation}, 0, 0)`)\r\n\r\n\r\n\r\n                    })\r\n                )\r\n\r\n\r\n\r\n            path.append(\"path\")\r\n                .attr(\"d\", arc)\r\n                .style(\"fill\", function (d) {\r\n\r\n                    if ((d.data.kind === 'vacancy' || d.data.kind === 'backfill') && d.data.name.endsWith(\"ENGINEERING\") ) {\r\n                        return 'url(#smallDot)'\r\n                    }\r\n                    if (d.data.kind === 'vacancy' || d.data.kind === 'backfill') {\r\n                        return 'url(#diagonalHatch)'\r\n                    }\r\n\r\n                    if(d.data.type && d.data.type !== \"EMPLOYEE\") {\r\n                        //return 'gray'\r\n                    }\r\n\r\n                    return color(label((d.children ? d : d.parent).data, true));\r\n                })\r\n                .attr(\"stroke\", \"black\")\r\n                .attr(\"stoke-width\", 0.2)\r\n                .attr(\"fill-opacity\", function(d) {\r\n\r\n                    if (d.data.startDate) {\r\n                        return 0.60\r\n                    }\r\n                    return 1\r\n                })\r\n                .style(\"mask\", (d) => {\r\n                    // can this be used for different employee styles?\r\n                    return null\r\n                })\r\n                .on(\"dblclick\", click)\r\n\r\n\r\n\r\n            const text = path.append(\"text\")\r\n                .text(function (d) {\r\n\r\n                    return label(d.data, 1)\r\n                })\r\n                .attr(\"x\", function (d) {\r\n                    return d.x;\r\n                })\r\n                .attr(\"text-anchor\", \"middle\")\r\n                // translate to the desired point and set the rotation\r\n                .attr(\"transform\", function (d) {\r\n                    if (d.depth > 0) {\r\n                        return \"translate(\" + arc.centroid(d) + \")\" +\r\n                            \"rotate(\" + getAngle(d) + \")\";\r\n                    } else {\r\n                        return null;\r\n                    }\r\n                })\r\n                .attr(\"dx\", \"3\") // margin\r\n                .attr(\"dy\", \".35em\") // vertical-align\r\n                .attr(\"pointer-events\", \"none\")\r\n                .style(\"font-size\", \"0.65em\")\r\n\r\n\r\n\r\n            function click(d, e) {\r\n\r\n                text.transition().attr(\"opacity\", 0);\r\n\r\n                viz.transition()\r\n                    .duration(350)\r\n                    .tween(\"scale\", function () {\r\n                        var xd = d3.interpolate(x.domain(), [d.x0, d.x1]),\r\n                            yd = d3.interpolate(y.domain(), [d.y0, 1]),\r\n                            yr = d3.interpolate(y.range(), [d.y0 ? 20 : 0, radius]);\r\n                        return function (t) {\r\n                            x.domain(xd(t));\r\n                            y.domain(yd(t)).range(yr(t));\r\n                        };\r\n                    })\r\n                    .selectAll(\"path\")\r\n                    .attrTween(\"d\", function (d) {\r\n                        return function () {\r\n                            return arc(d);\r\n                        };\r\n                    })\r\n                    .on(\"end\", function (e, i) {\r\n                        // check if the animated element's data e lies within the visible angle span given in d\r\n\r\n                        const inParent = checkWithinParent(e,d.data.id)\r\n\r\n                        if (\r\n                            inParent ||\r\n                            (e.data.id === d.data.id) // ||\r\n                           // (e.parent && e.parent.data.id === d.data.id) ||\r\n                            //(e.x0 >= d.x0 && e.x1 <= d.x1)\r\n                        ) {\r\n                            // get a selection of the associated text element\r\n                            var arcText = d3.select(this.parentNode).select(\"text\");\r\n                            // fade in the text element and recalculate positions\r\n                            arcText.transition().duration(750)\r\n                                .attr(\"opacity\", 1)\r\n                                .attr(\"transform\", function (d) {\r\n                                    if (d.depth > 0) {\r\n                                        return \"translate(\" + arc.centroid(e) + \")\" +\r\n                                            \"rotate(\" + getAngle(e) + \")\";\r\n                                    } else {\r\n                                        return null;\r\n                                    }\r\n                                })\r\n                                //.attr(\"transform\", function() { return \"rotate(\" + getAngle(e) + \")\" })\r\n                                //.attr(\"x\", function(d) { return y(d.y); })\r\n                                .attr(\"x\", function (d) {return e.x;})\r\n                        }\r\n                    });\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n","import React from 'react'\r\n\r\nimport Toggle from 'material-ui/Toggle';\r\n\r\nimport viz from './d3/visualisation'\r\nimport {exportToSVG} from './d3/visualisation'\r\nimport partition from './d3/partition'\r\n\r\nimport {Box, Flex} from 'reflexbox'\r\n\r\nimport {_moveNodesToChildren } from './state'\r\n\r\nimport SaveIcon from 'material-ui/svg-icons/content/save'\r\nimport IconButton from 'material-ui/IconButton';\r\n\r\nimport FileSaver from 'file-saver';\r\n\r\nclass GraphHolder extends React.Component {\r\n\r\n\r\n    shouldComponentUpdate() { return false }\r\n\r\n    renderChart(teams, showMembers, showVacancies) {\r\n\r\n        while (this.refs.chart.firstChild) {\r\n            this.refs.chart.removeChild(this.refs.chart.firstChild);\r\n        }\r\n\r\n        const preparedTeams = _moveNodesToChildren(teams, showMembers, showVacancies)\r\n\r\n        const teamsPartition = partition(preparedTeams)\r\n\r\n        viz('chart', teamsPartition, 'team-chart')\r\n\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps) {\r\n        if (!this.props.teams && !nextProps) {\r\n            return\r\n        }\r\n        if(nextProps.teams === this.props.teams && nextProps.members === this.props.members && nextProps.vacancies === this.props.vacancies) {\r\n            return\r\n        }\r\n\r\n        this.renderChart(nextProps.teams.toJS(), nextProps.members, nextProps.vacancies)\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (!this.props.teams) {\r\n            return\r\n        }\r\n        this.renderChart(this.props.teams.toJS(), this.props.members, this.props.vacancies)\r\n    }\r\n\r\n    render() {\r\n        return (<div id=\"chart\" ref=\"chart\"></div>)\r\n    }\r\n}\r\n\r\nexport default class TeamChart extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            showVacancies: true,\r\n            showMembers: true\r\n        }\r\n    }\r\n\r\n    toggleMembers = (_, showMembers) => {\r\n        this.setState({showMembers})\r\n    }\r\n\r\n    toggleVacancies = (_, showVacancies) => {\r\n        this.setState({showVacancies})\r\n    }\r\n\r\n    render() {\r\n\r\n        return (\r\n            <div>\r\n            <Flex p={0} align='center'>\r\n                <Box pb={0} w={1 / 4} style={{alignSelf: \"flex-start\"}}>\r\n                    <Toggle\r\n                        label=\"show members\"\r\n                        style={{width: \"15vw\"}}\r\n                        toggled={this.state.showMembers}\r\n                        ref=\"showMembers\"\r\n                        onToggle={this.toggleMembers}\r\n                    />\r\n                </Box>\r\n                <Box pb={0} w={1 / 4} style={{alignSelf: \"flex-start\"}}>\r\n                    <Toggle\r\n                        label=\"show vacancies\"\r\n                        style={{width: \"15vw\"}}\r\n                        toggled={this.state.showVacancies}\r\n                        ref=\"showVacancies\"\r\n                        onToggle={this.toggleVacancies}\r\n                    />\r\n                </Box>\r\n                <Box pb={0} w={1 / 4} style={{alignSelf: \"flex-start\"}}>\r\n                    <IconButton onClick={() => {\r\n                        const blob = exportToSVG('chart')\r\n                        FileSaver.saveAs(blob, 'team-structure.svg');\r\n                    }}>\r\n                        <SaveIcon />\r\n                    </IconButton>\r\n                </Box>\r\n            </Flex>\r\n            <GraphHolder teams={this.props.data.get('teams')} members={this.state.showMembers} vacancies={this.state.showVacancies}/>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React from 'react'\r\nimport {Bar, BarChart, CartesianGrid, Legend, ResponsiveContainer, Tooltip, XAxis, YAxis} from 'recharts'\r\n\r\nimport {List, ListItem} from 'material-ui/List'\r\n\r\nimport {STREAM, flattenTeamHierarchyExcluding} from './state'\r\n\r\n\r\nexport default class Stats extends React.Component {\r\n    render() {\r\n\r\n        if (!this.props.data.get(\"teams\")) {\r\n            return null\r\n        }\r\n\r\n        const team = this.props.data.get(\"teams\").toJS();\r\n\r\n        const employees = this.props.data.get(\"employees\").toJS();\r\n\r\n        const teamsById = this.props.data.get(\"teamsById\").toJS();\r\n\r\n        const teamsFlat = [team].reduce(flattenTeamHierarchyExcluding(), [])\r\n\r\n        return (\r\n            <div>\r\n                <div><h3>New Starters</h3><StartDateList employees={employees} teams={teamsById}/></div>\r\n                <div><h3>Contractors</h3><NonEmployees employees={employees} teams={teamsById}/></div>\r\n                <div><h3>Totals</h3><TwoLevelPieChart teams={teamsFlat}/></div>\r\n                <div><h3>Engineering</h3><StackedBarChart teams={teamsFlat} engineering title={\"Engineering\"}/></div>\r\n                <div><h3>Product</h3><StackedBarChart teams={teamsFlat} product/></div>\r\n                <div><h3>Design</h3><StackedBarChart teams={teamsFlat} design/></div>\r\n                <div><h3>Data</h3><StackedBarChart teams={teamsFlat} data/></div>\r\n                <div><h3>Operations</h3><StackedBarChart teams={teamsFlat} operations/></div>\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n\r\nfunction filterMembers({engineering, operations, portfolio, product, data, design}) {\r\n    return member => {\r\n        if (engineering && member.stream === STREAM.ENGINEERING) {\r\n            return true\r\n        }\r\n        if (operations && member.stream === STREAM.OPERATIONS) {\r\n            return true\r\n        }\r\n        if (portfolio && member.stream === STREAM.PORTFOLIO) {\r\n            return true\r\n        }\r\n        if (product && member.stream === STREAM.PRODUCT) {\r\n            return true\r\n        }\r\n        if (data && member.stream === STREAM.DATA) {\r\n            return true\r\n        }\r\n        if (design && member.stream === STREAM.DESIGN) {\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n}\r\n\r\nfunction countVacancies(vacancies, {engineering, operations, portfolio, product, data, design}) {\r\n\r\n    let tally = 0\r\n\r\n    if (!vacancies) {\r\n        return tally\r\n    }\r\n\r\n    if (engineering && vacancies['ENGINEERING']) {\r\n        tally += vacancies['ENGINEERING']\r\n    }\r\n    if (operations && vacancies['OPERATIONS']) {\r\n        tally += vacancies['OPERATIONS']\r\n    }\r\n    if (portfolio && vacancies['PORTFOLIO']) {\r\n        tally += vacancies['PORTFOLIO']\r\n    }\r\n    if (product && vacancies['PRODUCT']) {\r\n        tally += vacancies['PRODUCT']\r\n    }\r\n    if (data && vacancies['DATA']) {\r\n        tally += vacancies['DATA']\r\n    }\r\n    if (design && vacancies['DESIGN']) {\r\n        tally += vacancies['DESIGN']\r\n    }\r\n    if (isNaN(tally)) {\r\n        console.log(tally, vacancies)\r\n    }\r\n    return tally\r\n}\r\n\r\nconst StackedBarChart = ({teams, engineering, operations, portfolio, product, data, design, title}) => {\r\n\r\n    const memberFilter = filterMembers({engineering, operations, portfolio, product, data, design})\r\n\r\n    const datas = teams.map(t => {\r\n        const members = t.members.filter(memberFilter).length\r\n        const vacancies = countVacancies(t.vacancies, {engineering, operations, portfolio, product, data, design})\r\n        const backfills = countVacancies(t.backfills, {engineering, operations, portfolio, product, data, design})\r\n\r\n        if (t.name === \"Technology Department\" || (!vacancies && !members)) {\r\n            return null\r\n        }\r\n\r\n        return {name: t.name, members, vacancies, backfills}\r\n\r\n    }).filter(f => !!f)\r\n\r\n    return (\r\n        <ResponsiveContainer width={\"100%\"} minHeight={200}>\r\n            <BarChart data={datas}>\r\n                <XAxis dataKey=\"name\"></XAxis>\r\n                <YAxis/>\r\n                <CartesianGrid/>\r\n                <Tooltip/>\r\n                <Legend/>\r\n                <Bar dataKey=\"members\" stackId=\"a\" fill=\"#00ccc8\"/>\r\n                <Bar dataKey=\"vacancies\" stackId=\"a\" fill=\"#f5aa3c\"/>\r\n                <Bar dataKey=\"backfills\" stackId=\"a\" fill=\"#ea73ea\"/>\r\n            </BarChart>\r\n        </ResponsiveContainer>\r\n    )\r\n}\r\n\r\nconst TwoLevelPieChart = ({teams}) => {\r\n\r\n    const streams = {}\r\n\r\n    Object.keys(STREAM).forEach(st => {\r\n        streams[st] = {employees: 0, vacancies: 0, backfills: 0}\r\n    })\r\n\r\n    let max = 0\r\n\r\n    teams.forEach(t => {\r\n        t.members.forEach(m => {\r\n            streams[m.stream].employees += 1\r\n            max = max < streams[m.stream].employees ? streams[m.stream].employees : max\r\n        })\r\n\r\n        Object.keys(t.vacancies).forEach(st => {\r\n            streams[st].vacancies += t.vacancies[st]\r\n        })\r\n\r\n        Object.keys(t.backfills).forEach(st => {\r\n            streams[st].backfills += t.backfills[st]\r\n        })\r\n    })\r\n\r\n    const data = []\r\n\r\n    Object.keys(streams).forEach(st => {\r\n        data.push({stream: st, ...streams[st]})\r\n    })\r\n\r\n    return (\r\n        <ResponsiveContainer width={\"100%\"} minHeight={200}>\r\n            <BarChart data={data}>\r\n                <XAxis dataKey=\"stream\"/>\r\n                <YAxis/>\r\n                <CartesianGrid/>\r\n                <Tooltip/>\r\n                <Legend/>\r\n                <Bar dataKey=\"employees\" stackId=\"a\" fill=\"#00ccc8\"/>\r\n                <Bar dataKey=\"vacancies\" stackId=\"a\" fill=\"#f5aa3c\"/>\r\n                <Bar dataKey=\"backfills\" stackId=\"a\" fill=\"#ea73ea\"/>\r\n            </BarChart>\r\n        </ResponsiveContainer>\r\n\r\n    )\r\n}\r\n\r\nconst StartDateList = ({employees, teams}) => {\r\n    return (\r\n        <List>\r\n            {employees.filter(e => e.startDate).map(e => (\r\n                <ListItem key={e.id} primaryText={`${e.name} - ${e.memberOf ? teams[e.memberOf].name : 'Unassigned'}`} secondaryText={e.startDate} />\r\n            ))}\r\n        </List>\r\n    )\r\n}\r\n\r\nconst NonEmployees = ({employees, teams}) => {\r\n    return (\r\n        <List>\r\n            {employees.filter(e => e.type !== \"EMPLOYEE\").map(e => (\r\n                <ListItem key={e.id} primaryText={`${e.name} - ${e.memberOf ? teams[e.memberOf].name : 'Unassigned'}`} secondaryText={e.type} />\r\n            ))}\r\n        </List>\r\n    )\r\n}\r\n\r\n","import React from 'react'\r\n\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableHeader,\r\n    TableHeaderColumn,\r\n    TableRow,\r\n    TableRowColumn,\r\n} from 'material-ui/Table'\r\n\r\nfunction flattenTeamsFn(parents = []) {\r\n    return function flattenTeams(r, a) {\r\n        a.parents = parents.slice();\r\n        r.push(a);\r\n        const newParents = parents.slice()\r\n        newParents.push(a.name)\r\n        if (a.children && a.children.length > 0) {\r\n            a.children.reduce(flattenTeamsFn(newParents), r);\r\n        }\r\n        return r;\r\n    }\r\n}\r\n\r\nfunction findProductLeadNameUpwards(team, byId) {\r\n    if (team.productLead) {\r\n        return team.productLead.name\r\n    }\r\n\r\n    let current = team.parent\r\n\r\n    while(current) {\r\n\r\n        if (!byId[current]) return \"\"\r\n\r\n        if (byId[current].productLead) {\r\n            return byId[current].productLead.name\r\n        }\r\n        current = byId[current].parent\r\n    }\r\n\r\n    return \"\"\r\n}\r\n\r\nfunction findTechLeadNameUpwards(team, byId) {\r\n    if (team.techLead) {\r\n        return team.techLead.name\r\n    }\r\n\r\n    let current = team.parent\r\n\r\n    while(current) {\r\n\r\n        if (!byId[current]) return \"\"\r\n\r\n        if (byId[current].techLead) {\r\n            return byId[current].techLead.name\r\n        }\r\n        current = byId[current].parent\r\n    }\r\n\r\n    return \"\"\r\n}\r\n\r\n\r\n\r\nexport default class Leaders extends React.Component {\r\n\r\n    render() {\r\n\r\n        const teams = this.props.data.get('teams')\r\n\r\n        if (!teams) return null\r\n\r\n        const flatten = [teams.toJS()].reduce(flattenTeamsFn(), [])\r\n\r\n        const byId = flatten.reduce((teams, team) => {\r\n            teams[team.id] = team\r\n            return teams\r\n        }, {})\r\n\r\n        return (\r\n            <div>\r\n                <Table selectable={false}>\r\n                    <TableHeader adjustForCheckbox={false} enableSelectAll={false} displaySelectAll={false}>\r\n                        <TableRow>\r\n                            <TableHeaderColumn>Team</TableHeaderColumn>\r\n                            <TableHeaderColumn>Tech Lead</TableHeaderColumn>\r\n                            <TableHeaderColumn>Product Lead</TableHeaderColumn>\r\n                        </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody displayRowCheckbox={false}>\r\n                            {flatten.map(t => (\r\n                                <TableRow key={`${t.id}`}>\r\n                                    <TableRowColumn key={`${t.id}`} style={{paddingLeft: `${20*t.parents.length+20}px`}}>\r\n                                        {t.name}\r\n                                    </TableRowColumn>\r\n                                    <TableRowColumn style={{opacity: t.techLead ? 1 : 0.5}} key={`tlead_${t.id}`}>{findTechLeadNameUpwards(t, byId)}</TableRowColumn>\r\n                                    <TableRowColumn style={{opacity: t.productLead ? 1 : 0.5}} key={`plead_${t.id}`}>{findProductLeadNameUpwards(t, byId)}</TableRowColumn>\r\n                                </TableRow>\r\n                            ))}\r\n                    </TableBody>\r\n                </Table>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react'\r\n\r\nimport viz from './d3/visualisation'\r\nimport {exportToSVG} from './d3/visualisation'\r\nimport partition from './d3/partition'\r\n\r\nimport {Box, Flex} from 'reflexbox'\r\n\r\nimport SaveIcon from 'material-ui/svg-icons/content/save'\r\nimport IconButton from 'material-ui/IconButton';\r\n\r\nimport FileSaver from 'file-saver';\r\n\r\nclass GraphHolder extends React.Component {\r\n\r\n\r\n    shouldComponentUpdate() { return false }\r\n\r\n    renderChart(employees) {\r\n\r\n        while (this.refs.chart.firstChild) {\r\n            this.refs.chart.removeChild(this.refs.chart.firstChild);\r\n        }\r\n\r\n        const preparedEmployees = employees\r\n\r\n        const employeesPartition = partition(preparedEmployees)\r\n\r\n        viz('reporting-chart', employeesPartition, 'reporting-chart')\r\n\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps) {\r\n        if (!this.props.reporting && !nextProps) {\r\n            return\r\n        }\r\n        if(nextProps.reporting === this.props.reporting) {\r\n            return\r\n        }\r\n\r\n        this.renderChart(nextProps.reporting.toJS())\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (!this.props.reporting) {\r\n            return\r\n        }\r\n\r\n        this.renderChart(this.props.reporting.toJS())\r\n    }\r\n\r\n    render() {\r\n        return (<div id=\"reporting-chart\" ref=\"chart\"></div>)\r\n    }\r\n}\r\n\r\nexport default class ReportingChart extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        return (\r\n            <div>\r\n            <Flex p={0} align='center'>\r\n                <Box pb={0} w={1 / 4} style={{alignSelf: \"flex-start\"}}>\r\n                    <IconButton onClick={() => {\r\n                        const blob = exportToSVG('reporting-chart')\r\n                        FileSaver.saveAs(blob, 'reporting-structure.svg');\r\n                    }}>\r\n                        <SaveIcon />\r\n                    </IconButton>\r\n                </Box>\r\n            </Flex>\r\n            <GraphHolder reporting={this.props.data.get('reporting')}/>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from 'react';\r\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider';\r\n\r\nimport AdminApp from './Admin'\r\n\r\nimport {fromJS} from 'immutable'\r\n\r\nimport {Tab, Tabs} from 'material-ui/Tabs';\r\nimport RaisedButton from 'material-ui/RaisedButton';\r\nimport TextField from 'material-ui/TextField';\r\n\r\nimport Team from './Team'\r\nimport Stats from './Stats'\r\nimport Leaders from './Leaders'\r\nimport Reporting from './Reporting'\r\n\r\nexport default class App extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            admin: fromJS({\r\n                section: 'teams',\r\n                data: {\r\n                    teamsById: props.data.teamsById(),\r\n                    ...props.data.toLiteral()\r\n                },\r\n            })\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n\r\n        function getParameterByName(name) {\r\n            var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);\r\n            return match && decodeURIComponent(match[1].replace(/\\+/g, ' '));\r\n        }\r\n\r\n        let url = getParameterByName('q')\r\n\r\n        if (!url) {\r\n            url = localStorage.getItem(\"dataURL\")\r\n        }\r\n\r\n        if (url) {\r\n            this.props.data.loadData(url).then(() => {\r\n                this.bang()\r\n                const shareURL = `${window.location.protocol}//${window.location.hostname}:${window.location.port}${window.location.pathname}?q=${encodeURIComponent(url)}`\r\n\r\n                this.setState({url: shareURL})\r\n            })\r\n        }\r\n    }\r\n\r\n    bang = () => {\r\n        const state = this.state.admin.set('data', fromJS({\r\n            teamsById: this.props.data.teamsById(),\r\n            ...this.props.data.toLiteral()}))\r\n        this.setState({admin: state})\r\n    }\r\n\r\n    reparentTeam = (team, to) => {\r\n        this.props.data.reparentTeam(team, to)\r\n        this.bang()\r\n    }\r\n\r\n    addToTeam = (employee, to) => {\r\n        this.props.data.addToTeam(employee, to)\r\n        this.bang()\r\n    }\r\n\r\n    removeFromTeam = (employee) => {\r\n        this.props.data.removeFromTeam(employee)\r\n        this.bang()\r\n    }\r\n\r\n    exportData = () => {\r\n        this.setState({exportData: this.props.data.toJSON()})\r\n    }\r\n\r\n    importData = () => {\r\n        this.props.data.fromJSON(this.refs.importData.getValue())\r\n\r\n        this.bang()\r\n    }\r\n\r\n    changeHeadcount = (team, stream, headcount) => {\r\n        this.props.data.changeHeadcount(team, stream, headcount)\r\n        this.bang()\r\n    }\r\n\r\n    changeBackfills = (team, stream, headcount) => {\r\n        this.props.data.changeBackfills(team, stream, headcount)\r\n        this.bang()\r\n    }\r\n\r\n    addNewTeam = (name, kind, parent, description) => {\r\n        this.props.data.addNewTeam(name, kind, parent, description)\r\n        this.bang()\r\n    }\r\n\r\n    saveData = () => {\r\n\r\n        let url = this.refs.dataURL.getValue()\r\n\r\n        if (!url) {\r\n            url = localStorage.getItem(\"persistURL\")\r\n        }\r\n\r\n        if (url) {\r\n            this.props.data.saveData(url).then(() => {\r\n                this.bang()\r\n                const shareURL = `${window.location.protocol}//${window.location.hostname}:${window.location.port}${window.location.pathname}?q=${encodeURIComponent(url)}`\r\n\r\n                this.setState({url: shareURL})\r\n            })\r\n        } else {\r\n            alert(\"Could not work out persistence URL\")\r\n        }\r\n\r\n\r\n    }\r\n\r\n    loadData = () => {\r\n\r\n        const url = this.refs.dataURL.getValue()\r\n\r\n        this.props.data.loadData(url).then(\r\n            () => this.bang()\r\n        )\r\n\r\n\t\t\t\tconst shareURL = `${window.location.protocol}//${window.location.hostname}:${window.location.port}${window.location.pathname}?q=${encodeURIComponent(url)}`\r\n\r\n\t\t\t\tthis.setState({url: shareURL})\r\n    }\r\n\r\n    removeTeam = (team) => {\r\n        this.props.data.removeTeam(team)\r\n        this.bang()\r\n    }\r\n\r\n    changeTeamName = (id, name) => {\r\n        this.props.data.changeTeamName(id, name)\r\n        this.bang()\r\n    }\r\n\r\n    changeTeamDescription = (id, description) => {\r\n        this.props.data.changeTeamDescription(id, description)\r\n        this.bang()\r\n    }\r\n\r\n    addEmployee = (name, title, stream, reportsTo, employee, github, startDate, type) => {\r\n        this.props.data.addEmployee(name, title, stream, reportsTo, employee, github, startDate, type)\r\n        this.bang()\r\n    }\r\n\r\n    editEmployee = (id, name, title, stream, reportsTo, employee, github, startDate, type) => {\r\n        this.props.data.editEmployee(id, name, title, stream, reportsTo, employee, github, startDate, type)\r\n        this.bang()\r\n    }\r\n\r\n    removeEmployee = (id) => {\r\n        this.props.data.removeEmployee(id)\r\n        this.bang()\r\n    }\r\n\r\n    setTechLead = (team, lead) => {\r\n        this.props.data.setTechLead(team, lead)\r\n        this.bang()\r\n    }\r\n\r\n    setProductLead = (team, lead) => {\r\n        this.props.data.setProductLead(team, lead)\r\n        this.bang()\r\n    }\r\n\r\n    render() {\r\n\r\n        return (\r\n            <MuiThemeProvider>\r\n                <Tabs initialSelectedIndex={0}>\r\n                    <Tab label=\"Team Chart\">\r\n                        <Team data={this.state.admin.get('data')}></Team>\r\n                    </Tab>\r\n                    <Tab label=\"Reporting Chart\">\r\n                        <Reporting data={this.state.admin.get('data')}></Reporting>\r\n                    </Tab>\r\n                    <Tab label=\"Leaders\">\r\n                        <Leaders data={this.state.admin.get('data')}></Leaders>\r\n                    </Tab>\r\n                    <Tab label=\"Manage\">\r\n                        <AdminApp section={this.state.admin.get('section')} data={this.state.admin.get('data')}\r\n                                  actions={{\r\n                                      reparentTeam: this.reparentTeam,\r\n                                      addToTeam: this.addToTeam,\r\n                                      removeFromTeam: this.removeFromTeam,\r\n                                      changeHeadcount: this.changeHeadcount,\r\n                                      changeBackfills: this.changeBackfills,\r\n                                      addNewTeam: this.addNewTeam,\r\n                                      changeTeamName: this.changeTeamName,\r\n                                      changeTeamDescription: this.changeTeamDescription,\r\n                                      removeTeam: this.removeTeam,\r\n                                      addEmployee: this.addEmployee,\r\n                                      editEmployee: this.editEmployee,\r\n                                      removeEmployee: this.removeEmployee,\r\n                                      setTechLead: this.setTechLead,\r\n                                      setProductLead: this.setProductLead,\r\n                                  }}/>\r\n                    </Tab>\r\n                    <Tab label=\"STATS\">\r\n                        <Stats data={this.state.admin.get('data')}/>\r\n                    </Tab>\r\n                    <Tab label=\"DATA\">\r\n                        <div>\r\n                            <br/><br/>\r\n                            <TextField\r\n                                floatingLabelText=\"Share URL\"\r\n                                fullWidth={true}\r\n                                textareaStyle={{fontFamily: \"monospace\", fontSize: \"0.5em\", lineHeight: \"0.75em\"}}\r\n                                value={this.state.url ? this.state.url :\"\"}\r\n                            />\r\n                            <br/><br/>\r\n                            <TextField\r\n                                floatingLabelText=\"Data URL\"\r\n                                fullWidth={true}\r\n                                textareaStyle={{fontFamily: \"monospace\", fontSize: \"0.5em\", lineHeight: \"0.75em\"}}\r\n                                ref={\"dataURL\"}\r\n                            />\r\n                            <RaisedButton fullWidth={true} label={\"LOAD\"} onClick={this.loadData}/>\r\n                            <br/><br/>\r\n                            <RaisedButton fullWidth={true} label={\"SAVE\"} onClick={this.saveData}/>\r\n                            <br/><br/>\r\n                            <TextField\r\n                                floatingLabelText=\"Exported Data\"\r\n                                multiLine={true}\r\n                                rows={4}\r\n                                rowsMax={4}\r\n                                fullWidth={true}\r\n                                value={this.state.exportData}\r\n                                textareaStyle={{fontFamily: \"monospace\", fontSize: \"0.5em\", lineHeight: \"0.75em\"}}\r\n                            />\r\n                            <RaisedButton fullWidth={true} label={\"EXPORT\"} onClick={this.exportData}/>\r\n                            <br/><br/>\r\n                            <TextField\r\n                                floatingLabelText=\"Import Data\"\r\n                                multiLine={true}\r\n                                rows={4}\r\n                                rowsMax={4}\r\n                                fullWidth={true}\r\n                                textareaStyle={{fontFamily: \"monospace\", fontSize: \"0.5em\", lineHeight: \"0.75em\"}}\r\n                                ref={\"importData\"}\r\n                            />\r\n                            <RaisedButton fullWidth={true} label={\"IMPORT\"} onClick={this.importData}/>\r\n                        </div>\r\n                    </Tab>\r\n\r\n                </Tabs>\r\n            </MuiThemeProvider>\r\n        )\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport './index.css'\r\n\r\nimport App from './App';\r\n\r\nimport state from './state'\r\n\r\nReactDOM.render(<App data={state}/>, document.getElementById('root'));\r\n"],"sourceRoot":""}